# WB Techschool Order Service

Микросервис на Go для демонстрации работы с Kafka, PostgreSQL и in-memory кэшем. Сервис получает заказы из Kafka, сохраняет их в базу данных, кэширует 1000 последних заказов и предоставляет HTTP API и веб-интерфейс для просмотра заказов по ID.

## Быстрый старт

1. Склонируйте репозиторий и перейдите в папку L0:
   ```sh
   git clone https://github.com/Zusemar/wb-techschool.git
   cd wb-techschool/L0
   ```
2. Настройте переменные окружения (см. .env_sample, можно переопределять через make).
3. Запустите все сервисы и приложение одной командой:
   ```sh
   make dev
   ```
4. Откройте [http://localhost:8081](http://localhost:8081) для доступа к веб-интерфейсу.

## HTTP API

- `GET /order/{order_uid}` — получить заказ по ID. Возвращает JSON с данными заказа или 404, если не найден.
- `POST /order` — создать новый заказ. Принимает JSON заказа в теле запроса, возвращает созданный заказ и статус 201. Требуется поле `order_uid`.
- `GET /healthz` — проверка статуса сервиса (возвращает "ok").

## Описание
- Заказы поступают из Kafka, валидируются, сохраняются в PostgreSQL и кэшируются (1000 последних).
- При старте кэш восстанавливается из БД.
- Веб-интерфейс позволяет искать заказы по ID и создавать новые.

## Тесты

В проекте есть юнит- и интеграционные тесты (еще не до конца доделаны).

- **Юнит-тесты**: запускаются командой
  ```sh
  go test ./...
  ```
- **Интеграционные тесты**: требуют запущенной инфраструктуры (PostgreSQL, миграции). Запуск:
  ```sh
  go test -tags=integration ./integration/...
  ```
